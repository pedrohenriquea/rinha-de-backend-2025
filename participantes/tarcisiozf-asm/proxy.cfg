global
    maxconn 20000
    nbthread 1                 # 1 thread fits <=1 CPU and avoids lock contention
    # Optional small buffers for low latency & low memory (8k is plenty for most APIs):
    # tune.bufsize 8192

defaults
    mode http
    option http-keep-alive
    http-reuse always          # strongest reuse = fewer connects, lower latency
    timeout connect 1000ms
    timeout client  30s
    timeout server  30s
    # keep logs off unless debugging
    log /dev/log local0 notice
    option dontlog-normal

frontend fe
    bind :80
    default_backend be

backend be
    balance roundrobin
    option http-keep-alive
    http-reuse always
    # UDS backends on tmpfs; ensure your apps create these sockets with 0666 or dir 1777
    server s1 /sockets/one.sock maxconn 2048
    server s2 /sockets/two.sock maxconn 2048
